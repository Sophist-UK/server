#
# MDEV-32380 Array data type for stored routnes
#
CREATE TABLE array (array INT);
INSERT INTO array (array) VALUES (1);
UPDATE array SET array=Array+1;
SELECT array Array FROM array;
Array
2
SELECT array[array,array]=array[2,2] FROM array;
array[array,array]=array[2,2]
1
DROP TABLE array;
BEGIN NOT ATOMIC
DECLARE array int array[2] DEFAULT array[1,2];
SELECT array[1,2]=array;
SELECT array=array[`array`[1],`array`[2]];
END;
$$
array[1,2]=array
1
array=array[`array`[1],`array`[2]]
1
SELECT 1[1];
ERROR HY000: Illegal parameter data type int for operation '[]'
SELECT 10.1[1];
ERROR HY000: Illegal parameter data type decimal for operation '[]'
SELECT 10.1e0[1];
ERROR HY000: Illegal parameter data type double for operation '[]'
SELECT 'test'[1];
ERROR HY000: Illegal parameter data type varchar for operation '[]'
SELECT 0x6061[1];
ERROR HY000: Illegal parameter data type hex_hybrid for operation '[]'
SELECT TRUE[1];
ERROR HY000: Illegal parameter data type boolean for operation '[]'
SELECT NULL[1];
ERROR HY000: Illegal parameter data type null for operation '[]'
SELECT ROW(1,2)[1];
ERROR HY000: Illegal parameter data type row for operation '[]'
SELECT (1)[1];
ERROR HY000: Illegal parameter data type int for operation '[]'
SELECT (ROW(1,2))[1];
ERROR HY000: Illegal parameter data type row for operation '[]'
SELECT (1 IS NULL)[1];
ERROR HY000: Illegal parameter data type boolean for operation '[]'
SELECT 1 IS NULL [1];
ERROR 42000: You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near '[1]' at line 1
SELECT _latin1'a' COLLATE latin1_bin [1];
ERROR 42000: You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near '[1]' at line 1
SELECT (SELECT 1 FROM DUAL)[0];
ERROR 42000: This version of MariaDB doesn't yet support 'ARRAY reference for this expression type'
SELECT ARRAY[1,2][1];
ERROR 42000: This version of MariaDB doesn't yet support 'ARRAY reference for this expression type'
SELECT ARRAY[1,2,3]=ARRAY[1,2,3];
ARRAY[1,2,3]=ARRAY[1,2,3]
1
EXPLAIN EXTENDED SELECT array[1,2,3]=array[1,2,3];
id	select_type	table	type	possible_keys	key	key_len	ref	rows	filtered	Extra
1	SIMPLE	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	No tables used
Warnings:
Note	1003	select ARRAY[1,2,3] = ARRAY[1,2,3] AS `array[1,2,3]=array[1,2,3]`
SELECT ARRAY[1,2,3]=123;
ERROR HY000: Illegal parameter data types array and int for operation '='
SELECT ARRAY[1,2,3]='1,2,3';
ERROR HY000: Illegal parameter data types array and varchar for operation '='
SELECT ROW(1,2,3)=ARRAY[1,2,3];
ERROR HY000: Illegal parameter data types row and array for operation '='
SELECT ARRAY[1,2,3]=ROW(1,2,3);
ERROR HY000: Illegal parameter data types array and row for operation '='
SELECT ARRAY[1,2,3];
ERROR 21000: Operand should contain 1 column(s)
CREATE TABLE t1 AS SELECT ARRAY[1,2,3];
ERROR 21000: Operand should contain 1 column(s)
SELECT NOT ARRAY[1,2,3];
ERROR 21000: Operand should contain 1 column(s)
SELECT ARRAY[1,2,3] + ARRAY[1,2,3];
ERROR HY000: Illegal parameter data types array and array for operation '+'
SELECT ARRAY[1,2,3] - ARRAY[1,2,3];
ERROR HY000: Illegal parameter data types array and array for operation '-'
SELECT ARRAY[1,2,3] * ARRAY[1,2,3];
ERROR HY000: Illegal parameter data types array and array for operation '*'
SELECT ARRAY[1,2,3] / ARRAY[1,2,3];
ERROR HY000: Illegal parameter data types array and array for operation '/'
EXECUTE IMMEDIATE 'SELECT ARRAY[1,2,3] = ?' USING ARRAY[1,2,3];
ERROR 21000: Operand should contain 1 column(s)
